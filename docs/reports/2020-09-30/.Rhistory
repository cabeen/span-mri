# Chunk 1: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
df <- read.csv("histograms.csv")
df$site <- df$site_dicom
t2fitLow <- 12.5
t2fitHigh <- 40
t2harmLow <- 0.15
t2harmHigh <- 1.5
adcfitLow <- 0.0001
adcfitHigh <- 0.002
adcharmLow <- 0.01
adcharmHigh <- 3
# Chunk 2: plot_all_t2_rate_share
subdf <- df[df$type == "fit" & df$param == "t2_rate",];
fit.plot <- ggplot(data=subdf, aes(x=name, y=value, color=site, group=site)) + xlim(t2fitLow,t2fitHigh) + geom_point(alpha=0.15)  + geom_smooth(span=0.1) + xlab("Raw T2 Rate (reciprocal)") + ylab("Voxel Count") + ggtitle("Raw T2 Star Parameters Across Sites")
subdf <- df[df$type == "harm" & df$param == "t2_rate",];
harm.plot <- ggplot(data=subdf, aes(x=name, y=value, color=site, group=site)) + xlim(t2harmLow,t2harmHigh) + geom_point(alpha=0.15)  + geom_smooth(span=0.1) + xlab("Harmonized T2 Rate (reciprocal)") + ylab("Voxel Count") + ggtitle("Harmonized T2 Star Parameters Across Sites")
grid.arrange(fit.plot, harm.plot, nrow = 2)
# Chunk 3: plot_all_adc_rate_share
subdf <- df[df$type == "fit" & df$param == "adc_rate",];
fit.plot <- ggplot(data=subdf, aes(x=name, y=value, color=site, group=site)) + xlim(adcfitLow,adcfitHigh) + geom_point(alpha=0.15)  + geom_smooth(span=0.1) + xlab("Raw ADC") + ylab("Voxel Count") + ggtitle("Raw ADC Across Sites")
subdf <- df[df$type == "harm" & df$param == "adc_rate",];
harm.plot <- ggplot(data=subdf, aes(x=name, y=value, color=site, group=site)) + xlim(adcharmLow,adcharmHigh) + geom_point(alpha=0.15)  + geom_smooth(span=0.1) + xlab("Harmonized ADC") + ylab("Voxel Count") + ggtitle("Harmonized ADC Across Sites")
grid.arrange(fit.plot, harm.plot, nrow = 2)
subdf

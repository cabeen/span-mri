# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] + coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Whole Brain Normal-appearing Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, volume_tissue ~ volume_lesion + site))
# Chunk 1: global_options
w = 7
h = 7
#knitr::opts_chunk$set(fig.width=w, fig.height=h, fig.path='figs/',
#                      echo=FALSE, warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
options(xtable.comment = FALSE)
# Chunk 2: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
library(reshape2)
library(dplyr)
df <- read.csv("SPAN-Stage1-DataTable-2021-05-26.csv")
early.df <- df[df$timepoint == "early", c("site", "subject", "volume_lesion", "volume_tissue", "volume_csf")]
early.df$early_lesion <- early.df$volume_lesion
early.df$early_tissue <- early.df$volume_tissue
early.df$early_csf    <- early.df$volume_csf
early.df <- early.df[,c("site", "subject", "early_lesion", "early_tissue", "early_csf")]
early.df$early_total <- early.df$early_lesion + early.df$early_csf + early.df$early_tissue
late.df <- df[df$timepoint == "late", c("subject", "midline_tissue_volume_left", "midline_tissue_volume_right", "volume_tissue", "volume_csf")]
late.df$late_midline_left <- late.df$midline_tissue_volume_left
late.df$late_midline_right <- late.df$midline_tissue_volume_right
late.df$late_tissue <- late.df$volume_tissue
late.df$late_csf    <- late.df$volume_csf
late.df <- late.df[,c("subject", "late_tissue", "late_csf", "late_midline_left", "late_midline_right")]
late.df$late_total <- late.df$late_csf + late.df$late_tissue
compare.df <- merge(early.df, late.df, by="subject")
# early_mean <- mean(compare.df$early_total)
# late_mean <- mean(compare.df$late_total)
# early_sd <- sd(compare.df$early_total)
# late_sd <- sd(compare.df$late_total)
#
# stats <- NULL
#
# for (site in unique(compare.df$site))
# {
#    filter <- compare.df$site == site
#    stats[[site]] <- list(early_mean=mean(compare.df$early_total[filter]),
#                              early_sd=sd(compare.df$early_total[filter]),
#                              late_mean=mean(compare.df$late_total[filter]),
#                              late_sd=sd(compare.df$late_total[filter]))
# }
#
# for (i in c(1:nrow(compare.df)))
# {
#     my.stats <- stats[[compare.df[i, "site"]]]
#
#     for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
#     }
#
#     for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + late_sd * (compare.df[i, j] - my.stats$late_mean) / my.stats$late_sd
#     }
# }
# Chunk 3: plot_snr
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Whole Brain Normal-appearing Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, volume_tissue ~ volume_lesion))
#summary(lm(data=compare.df, volume_tissue ~ volume_lesion + site))
#summary(lm(data=compare.df, volume_tissue ~ volume_lesion * site))
# Chunk 4: plot_snr
model <- lm(data=compare.df, late_tissue ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] + coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Whole Brain Normal-appearing Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
compare.df$site != "YL"
summary(lm(data=compare.df[compare.df$site != "YL"], late_tissue ~ early_lesion + site))
summary(lm(data=compare.df[compare.df$site != "YL",], late_tissue ~ early_lesion + site))
summary(lm(data=compare.df[compare.df$site != "YL",], late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_midline_right ~ early_lesion + site))
summary(lm(data=compare.df, late_midline_left ~ early_lesion + site))
summary(lm(data=compare.df, late_csf ~ early_lesion + site))
summary(lm(data=compare.df, late_total ~ early_lesion + site))
# Chunk 1: global_options
w = 7
h = 7
#knitr::opts_chunk$set(fig.width=w, fig.height=h, fig.path='figs/',
#                      echo=FALSE, warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
options(xtable.comment = FALSE)
# Chunk 2: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
library(reshape2)
library(dplyr)
df <- read.csv("SPAN-Stage1-DataTable-2021-05-26.csv")
early.df <- df[df$timepoint == "early", c("site", "subject", "volume_lesion", "volume_tissue", "volume_csf")]
early.df$early_lesion <- early.df$volume_lesion
early.df$early_tissue <- early.df$volume_tissue
early.df$early_csf    <- early.df$volume_csf
early.df <- early.df[,c("site", "subject", "early_lesion", "early_tissue", "early_csf")]
early.df$early_total <- early.df$early_lesion + early.df$early_csf + early.df$early_tissue
late.df <- df[df$timepoint == "late", c("subject", "midline_tissue_volume_left", "midline_tissue_volume_right", "volume_tissue", "volume_csf")]
late.df$late_midline_left <- late.df$midline_tissue_volume_left
late.df$late_midline_right <- late.df$midline_tissue_volume_right
late.df$late_tissue <- late.df$volume_tissue
late.df$late_csf    <- late.df$volume_csf
late.df <- late.df[,c("subject", "late_tissue", "late_csf", "late_midline_left", "late_midline_right")]
late.df$late_total <- late.df$late_csf + late.df$late_tissue
compare.df <- merge(early.df, late.df, by="subject")
# early_mean <- mean(compare.df$early_total)
# late_mean <- mean(compare.df$late_total)
# early_sd <- sd(compare.df$early_total)
# late_sd <- sd(compare.df$late_total)
#
# stats <- NULL
#
# for (site in unique(compare.df$site))
# {
#    filter <- compare.df$site == site
#    stats[[site]] <- list(early_mean=mean(compare.df$early_total[filter]),
#                              early_sd=sd(compare.df$early_total[filter]),
#                              late_mean=mean(compare.df$late_total[filter]),
#                              late_sd=sd(compare.df$late_total[filter]))
# }
#
# for (i in c(1:nrow(compare.df)))
# {
#     my.stats <- stats[[compare.df[i, "site"]]]
#
#     for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
#     }
#
#     for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + late_sd * (compare.df[i, j] - my.stats$late_mean) / my.stats$late_sd
#     }
# }
# Chunk 3: plot_raw
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Whole Brain Normal-appearing Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion))
# Chunk 4: plot_harm
model <- lm(data=compare.df, late_tissue ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Whole Brain Normal-appearing Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
# Chunk 1: global_options
w = 7
h = 7
#knitr::opts_chunk$set(fig.width=w, fig.height=h, fig.path='figs/',
#                      echo=FALSE, warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
options(xtable.comment = FALSE)
# Chunk 2: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
library(reshape2)
library(dplyr)
df <- read.csv("SPAN-Stage1-DataTable-2021-05-26.csv")
early.df <- df[df$timepoint == "early", c("site", "subject", "volume_lesion", "volume_tissue", "volume_csf")]
early.df$early_lesion <- early.df$volume_lesion
early.df$early_tissue <- early.df$volume_tissue
early.df$early_csf    <- early.df$volume_csf
early.df <- early.df[,c("site", "subject", "early_lesion", "early_tissue", "early_csf")]
early.df$early_total <- early.df$early_lesion + early.df$early_csf + early.df$early_tissue
late.df <- df[df$timepoint == "late", c("subject", "midline_tissue_volume_left", "midline_tissue_volume_right", "volume_tissue", "volume_csf")]
late.df$late_midline_left <- late.df$midline_tissue_volume_left
late.df$late_midline_right <- late.df$midline_tissue_volume_right
late.df$late_tissue <- late.df$volume_tissue
late.df$late_csf    <- late.df$volume_csf
late.df <- late.df[,c("subject", "late_tissue", "late_csf", "late_midline_left", "late_midline_right")]
late.df$late_total <- late.df$late_csf + late.df$late_tissue
compare.df <- merge(early.df, late.df, by="subject")
# early_mean <- mean(compare.df$early_total)
# late_mean <- mean(compare.df$late_total)
# early_sd <- sd(compare.df$early_total)
# late_sd <- sd(compare.df$late_total)
#
# stats <- NULL
#
# for (site in unique(compare.df$site))
# {
#    filter <- compare.df$site == site
#    stats[[site]] <- list(early_mean=mean(compare.df$early_total[filter]),
#                              early_sd=sd(compare.df$early_total[filter]),
#                              late_mean=mean(compare.df$late_total[filter]),
#                              late_sd=sd(compare.df$late_total[filter]))
# }
#
# for (i in c(1:nrow(compare.df)))
# {
#     my.stats <- stats[[compare.df[i, "site"]]]
#
#     for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
#     }
#
#     for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + late_sd * (compare.df[i, j] - my.stats$late_mean) / my.stats$late_sd
#     }
# }
# Chunk 3: plot_raw
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion))
# Chunk 4: plot_harm
model <- lm(data=compare.df, late_tissue ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
# Chunk 5: plot_ipsi
model <- lm(data=compare.df, late_midline_right ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_midline_right_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Ipsilateral Hemi Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
compare.df$late_midline_right_harm
compare.df$late_midline_right
model
compare.df
# Chunk 1: global_options
w = 7
h = 7
#knitr::opts_chunk$set(fig.width=w, fig.height=h, fig.path='figs/',
#                      echo=FALSE, warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
options(xtable.comment = FALSE)
# Chunk 2: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
library(reshape2)
library(dplyr)
df <- read.csv("SPAN-Stage1-DataTable-2021-05-26.csv")
early.df <- df[df$timepoint == "early", c("site", "subject", "volume_lesion", "volume_tissue", "volume_csf")]
early.df$early_lesion <- early.df$volume_lesion
early.df$early_tissue <- early.df$volume_tissue
early.df$early_csf    <- early.df$volume_csf
early.df <- early.df[,c("site", "subject", "early_lesion", "early_tissue", "early_csf")]
early.df$early_total <- early.df$early_lesion + early.df$early_csf + early.df$early_tissue
late.df <- df[df$timepoint == "late", c("subject", "midline_tissue_volume_left", "midline_tissue_volume_right", "volume_tissue", "volume_csf")]
late.df$late_midline_left <- late.df$midline_tissue_volume_left
late.df$late_midline_right <- late.df$midline_tissue_volume_right
late.df$late_tissue <- late.df$volume_tissue
late.df$late_csf    <- late.df$volume_csf
late.df <- late.df[,c("subject", "late_tissue", "late_csf", "late_midline_left", "late_midline_right")]
late.df$late_total <- late.df$late_csf + late.df$late_tissue
compare.df <- merge(early.df, late.df, by="subject")
# early_mean <- mean(compare.df$early_total)
# late_mean <- mean(compare.df$late_total)
# early_sd <- sd(compare.df$early_total)
# late_sd <- sd(compare.df$late_total)
#
# stats <- NULL
#
# for (site in unique(compare.df$site))
# {
#    filter <- compare.df$site == site
#    stats[[site]] <- list(early_mean=mean(compare.df$early_total[filter]),
#                              early_sd=sd(compare.df$early_total[filter]),
#                              late_mean=mean(compare.df$late_total[filter]),
#                              late_sd=sd(compare.df$late_total[filter]))
# }
#
# for (i in c(1:nrow(compare.df)))
# {
#     my.stats <- stats[[compare.df[i, "site"]]]
#
#     for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
#     }
#
#     for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + late_sd * (compare.df[i, j] - my.stats$late_mean) / my.stats$late_sd
#     }
# }
# Chunk 3: plot_raw
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion))
# Chunk 4: plot_harm
model <- lm(data=compare.df, late_tissue ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
# Chunk 5: plot_ipsi
model <- lm(data=compare.df, late_midline_right ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_new", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_midline_right_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Ipsilateral Hemi Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
head(compare.df)
coef
model
model <- lm(data=compare.df, late_midline_right ~ early_lesion + site)
summary(model <- lm(data=compare.df, late_midline_right ~ early_lesion + site))
summary(model <- lm(data=compare.df, late_tissue ~ early_lesion + site))
# Chunk 1: global_options
w = 7
h = 7
#knitr::opts_chunk$set(fig.width=w, fig.height=h, fig.path='figs/',
#                      echo=FALSE, warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
options(xtable.comment = FALSE)
# Chunk 2: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
library(reshape2)
library(dplyr)
df <- read.csv("SPAN-Stage1-DataTable-2021-05-26.csv")
early.df <- df[df$timepoint == "early", c("site", "subject", "volume_lesion", "volume_tissue", "volume_csf")]
early.df$early_lesion <- early.df$volume_lesion
early.df$early_tissue <- early.df$volume_tissue
early.df$early_csf    <- early.df$volume_csf
early.df <- early.df[,c("site", "subject", "early_lesion", "early_tissue", "early_csf")]
early.df$early_total <- early.df$early_lesion + early.df$early_csf + early.df$early_tissue
late.df <- df[df$timepoint == "late", c("subject", "midline_tissue_volume_left", "midline_tissue_volume_right", "volume_tissue", "volume_csf")]
late.df$late_midline_left <- late.df$midline_tissue_volume_left
late.df$late_midline_right <- late.df$midline_tissue_volume_right
late.df$late_tissue <- late.df$volume_tissue
late.df$late_csf    <- late.df$volume_csf
late.df <- late.df[,c("subject", "late_tissue", "late_csf", "late_midline_left", "late_midline_right")]
late.df$late_total <- late.df$late_csf + late.df$late_tissue
compare.df <- merge(early.df, late.df, by="subject")
# early_mean <- mean(compare.df$early_total)
# late_mean <- mean(compare.df$late_total)
# early_sd <- sd(compare.df$early_total)
# late_sd <- sd(compare.df$late_total)
#
# stats <- NULL
#
# for (site in unique(compare.df$site))
# {
#    filter <- compare.df$site == site
#    stats[[site]] <- list(early_mean=mean(compare.df$early_total[filter]),
#                              early_sd=sd(compare.df$early_total[filter]),
#                              late_mean=mean(compare.df$late_total[filter]),
#                              late_sd=sd(compare.df$late_total[filter]))
# }
#
# for (i in c(1:nrow(compare.df)))
# {
#     my.stats <- stats[[compare.df[i, "site"]]]
#
#     for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
#     }
#
#     for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
#     {
#       compare.df[i, sprintf("%s_harm", j)] <- late_mean + late_sd * (compare.df[i, j] - my.stats$late_mean) / my.stats$late_sd
#     }
# }
# Chunk 3: plot_raw
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion))
# Chunk 4: plot_harm
model <- lm(data=compare.df, late_tissue ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
if (is.na(coef))
{
coef <- 0
}
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_harm", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_tissue_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
# Chunk 5: plot_ipsi
model <- lm(data=compare.df, late_midline_right ~ early_lesion + site)
for (i in c(1:nrow(compare.df)))
{
coef <- model$coefficients[sprintf("site%s", compare.df[i, "site"])]
if (is.na(coef))
{
coef <- 0
}
# for (j in c("early_tissue", "early_csf", "early_lesion", "early_total"))
# {
#   compare.df[i, sprintf("%s_harm", j)] <- late_mean + (compare.df[i, j] - my.stats$late_mean)
# }
for (j in c("late_tissue", "late_csf", "late_total", "late_midline_left", "late_midline_right"))
{
compare.df[i, sprintf("%s_new", j)] <- compare.df[i, j] - coef
}
}
ggplot(data=compare.df, aes(x=early_lesion, y=late_midline_right_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + ylim(280, 400) + xlab("Lesion Volume at Early Timepoint") + ylab("Ipsilateral Hemi Tissue Volume at Late Timepoint")
summary(lm(data=compare.df, late_tissue ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion + site))
summary(lm(data=compare.df, late_tissue_harm ~ early_lesion))
head(compare.df)
compare.df$=late_midline_right_harm
compare.df$late_midline_right_harm
ggplot(data=compare.df, aes(x=early_lesion, y=late_midline_right_harm, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + xlab("Lesion Volume at Early Timepoint") + ylab("Ipsilateral Hemi Tissue Volume at Late Timepoint")
ggplot(data=compare.df, aes(x=early_lesion, y=late_midline_right_new, color=site, group=site)) + geom_point() + geom_smooth(method="lm") + xlim(0, 120) + xlab("Lesion Volume at Early Timepoint") + ylab("Ipsilateral Hemi Tissue Volume at Late Timepoint")

install.packages("ggplot2")
install.packages("papeR")
install.packages("stargazer")
install.packages("gridExtra")
install.packages("xtable")
summary(lm(ODI_FIC_R ~ Age))
summary(lm(ODI_FIC_R ~ Age, df.std))
df.std
df.std
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
std.var <- function(values)
{
return ((values - mean(values, na.rm=T)) / sd(values, na.rm=T))
}
inlier.var <- function(values, range=1.5)
{
qnt <- quantile(values, probs=c(.25, .75)); H <- range * IQR(values)
return(values > (qnt[1] - H) & values < (qnt[2] + H))
}
read.table <- function(img.fn)
{
img.df <- read.csv(img.fn)
for(i in 1:ncol(img.df)){
img.df[is.na(img.df[,i]), i] <- mean(img.df[,i], na.rm = TRUE)
}
metrics <- names(img.df)[-1]
df <- img.df
df <- merge(df, read.csv("../meta/unrestricted_behavioral.csv"))
df <- merge(df, read.csv("../meta/restricted.csv"))
df$ICV <- df$FS_IntraCranial_Vol
df$Sex <- df$Gender
df$ThoughtProblems <- df$ASR_Thot_T
df$Cognition <- df$CogTotalComp_AgeAdj
df$Memory <- df$WM_Task_Acc
df$LifeSatisfaction <- df$LifeSatisf_Unadj
df$CannabisDose <- df$SSAGA_Mj_Times_Used
df$PaternalAlcohol <- df$FamHist_Fath_DrgAlc
df$PaternalAlcohol <- as.factor(df$PaternalAlcohol)
#df$DailySmoke <- as.factor(df$Num_Days_Used_Any_Tobacco_7days > 6)
#df$DailyDrink <- as.factor(df$Num_Days_Drank_7days > 6)
df$DailySmoke <- df$Num_Days_Used_Any_Tobacco_7days
df$DailyDrink <- df$Num_Days_Drank_7days
df$Age <- df$Age_in_Yrs
df$HeavyMj <- as.factor(df$CannabisDose > 3)
# CannabisDose = Times used marijuana:
# never used = 0; 1-5 = 1; 6-10 = 2; 11-25 = 3; 26-50 = 3;
# 51-100 = 3; 101-999 = 4; 1000-2000 = 5; >2000 = 5
df$PaternalAlcohol <- as.factor(df$PaternalAlcohol)
levels(df$PaternalAlcohol) <- c("false", "true")
levels(df$Sex) <- c("Female", "Male")
return(df)
}
df.roi.odi    <- read.table("../data/table.roi.diff.allman.noddi.nODI_median.wide.csv")
df.roi.fa     <- read.table("../data/table.roi.diff.allman.fwdti.tFA_median.wide.csv")
df.lhmesh.odi <- read.table("../data/table.mesh.lh.ODI_mean.wide.csv")
df.lhmesh.fa  <- read.table("../data/table.mesh.lh.FA_mean.wide.csv")
df.rhmesh.odi <- read.table("../data/table.mesh.rh.ODI_mean.wide.csv")
df.rhmesh.fa  <- read.table("../data/table.mesh.rh.FA_mean.wide.csv")
df.amy.odi    <- read.table("../data/table.roi.diff.cit.amy.noddi.nODI_mean.wide.csv")
df.amy.fa     <- read.table("../data/table.roi.diff.cit.amy.fwdti.tFA_mean.wide.csv")
varonly <- function(df, from.name, to.name)
{
out.df <- data.frame(subject=df$subject)
out.df[,to.name] <- df[,from.name]
return(out.df)
}
df <- df.roi.odi
df <- merge(df, varonly(df.roi.odi, "fic_right", "ODI_FIC_R"))
df <- merge(df, varonly(df.roi.odi, "fic_left",  "ODI_FIC_L"))
df <- merge(df, varonly(df.roi.fa,  "fic_right", "FA_FIC_R"))
df <- merge(df, varonly(df.roi.fa,  "fic_left",  "FA_FIC_L"))
df <- merge(df, varonly(df.amy.odi, "AMY_BLN_La", "ODI_AMY_BLN_La"))
df <- merge(df, varonly(df.amy.fa,  "AMY_BLN_La", "FA_AMY_BLN_La"))
df <- merge(df, varonly(df.amy.odi, "AMY_ATA_ASTA", "ODI_AMY_ATA_ASTA"))
df <- merge(df, varonly(df.amy.fa,  "AMY_ATA_ASTA", "FA_AMY_ATA_ASTA"))
df <- merge(df, varonly(df.amy.odi, "AMY", "ODI_AMY_EXTRA"))
df <- merge(df, varonly(df.amy.fa,  "AMY", "FA_AMY_EXTRA"))
df <- merge(df, varonly(df.rhmesh.odi, "R_AAIC_ROI", "ODI_AAIC_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_AAIC_ROI", "ODI_AAIC_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_AAIC_ROI", "FA_AAIC_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_AAIC_ROI", "FA_AAIC_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_10r_ROI", "ODI_BA10r_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_10r_ROI", "ODI_BA10r_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_10r_ROI", "FA_BA10r_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_10r_ROI", "FA_BA10r_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_10d_ROI", "ODI_BA10d_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_10d_ROI", "ODI_BA10d_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_10d_ROI", "FA_BA10d_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_10d_ROI", "FA_BA10d_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_p32_ROI", "ODI_BAp32_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_p32_ROI", "ODI_BAp32_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_p32_ROI", "FA_BAp32_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_p32_ROI", "FA_BAp32_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_s32_ROI", "ODI_BAs32_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_s32_ROI", "ODI_BAs32_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_s32_ROI", "FA_BAs32_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_s32_ROI", "FA_BAs32_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_d32_ROI", "ODI_BAd32_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_d32_ROI", "ODI_BAd32_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_d32_ROI", "FA_BAd32_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_d32_ROI", "FA_BAd32_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_a24_ROI", "ODI_BAa24_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_a24_ROI", "ODI_BAa24_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_a24_ROI", "FA_BAa24_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_a24_ROI", "FA_BAa24_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_25_ROI", "ODI_BA25_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_25_ROI", "ODI_BA25_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_25_ROI", "FA_BA25_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_25_ROI", "FA_BA25_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_p24_ROI", "ODI_BAp24_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_p24_ROI", "ODI_BAp24_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_p24_ROI", "FA_BAp24_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_p24_ROI", "FA_BAp24_L"))
df <- merge(df, varonly(df.rhmesh.odi, "R_9m_ROI", "ODI_BA9m_R"))
df <- merge(df, varonly(df.lhmesh.odi, "L_9m_ROI", "ODI_BA9m_L"))
df <- merge(df, varonly(df.rhmesh.fa,  "R_9m_ROI", "FA_BA9m_R"))
df <- merge(df, varonly(df.lhmesh.fa,  "L_9m_ROI", "FA_BA9m_L"))
vars <- c("FIC", "AAIC", "BA10r", "BA10d", "BAp32", "BAs32", "BAd32", "BAa24", "BA25", "BAp24", "BA9m")
amys <- c("AMY_BLN_La", "AMY_ATA_ASTA", "AMY_EXTRA")
for (name in vars)
{
for (p in c("ODI", "FA"))
{
left <- df[,sprintf("%s_%s_L", p, name)]
right <- df[,sprintf("%s_%s_R", p, name)]
both <- 0.5 * (left + right)
df[,sprintf("%s_%s", p, name)] <- both
df[,sprintf("%s_%s_inlier", p, name)] <- inlier.var(both)
df[,sprintf("%s_%s_L_inlier", p, name)] <- inlier.var(left)
df[,sprintf("%s_%s_R_inlier", p, name)] <- inlier.var(right)
# remove terrible outliers
df <- df[inlier.var(both, range=5),]
}
}
for (name in amys)
{
for (p in c("ODI", "FA"))
{
values <- df[,sprintf("%s_%s", p, name)]
df[,sprintf("%s_%s_inlier", p, name)] <- inlier.var(values)
# remove terrible outliers
df <- df[inlier.var(values, range=5),]
}
}
df.std <- df
for (name in vars)
{
for (p in c("ODI", "FA"))
{
df.std[,sprintf("%s_%s", p, name)] <- std.var(df[,sprintf("%s_%s", p, name),])
df.std[,sprintf("%s_%s_L", p, name)] <- std.var(df[,sprintf("%s_%s_L", p, name),])
df.std[,sprintf("%s_%s_R", p, name)] <- std.var(df[,sprintf("%s_%s_R", p, name),])
}
}
for (name in amys)
{
for (p in c("ODI", "FA"))
{
df.std[,sprintf("%s_%s", p, name)] <- std.var(df[,sprintf("%s_%s", p, name),])
}
}
df.std$Age <- std.var(df$Age)
df.std$ThoughtProblems <- std.var(df$ThoughtProblems)
df.std$Cognition <- std.var(df$Cognition)
df.std$Memory <- std.var(df$Memory)
df.std$LifeSatisfaction <- std.var(df$LifeSatisfaction)
df.std$ICV <- std.var(df$ICV)
summary(lm(FIC_ODI ~ Age, df.std))
summary(lm(FIC_ODI_R ~ Age, df.std))
summary(lm(ODI_FIC_R ~ Age, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex * LifeSatisfaction, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + Age * LifeSatisfaction, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + ThoughtProblems, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction * ThoughtProblems, df.std))
df.std$LifeSatisfaction
df.std$LISAD <- df$std$LifeSatisfaction < 0
df.std$LISAD <- df.std$LifeSatisfaction < 0
summary(lm(ODI_FIC_R ~ Age + Sex + LISAD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LISAD * ThoughtProblems, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + ThoughtProblems, df.std))
df.std$TBD <- df.std$ThoughtProblems < 0
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + ThoughtProblems, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + TBD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + TBD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + TBD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction * TBD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + TBD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + TBD, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction * SSAGA_Educ, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + MMSE_Score, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
names(df.std)
summary(lm(ODI_AMY_BLN_La_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_AMY_BLN_La ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_AMY_CEN ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_AMY_ATA_ASTA ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_AAIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_AAIC_L ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_FIC_L ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(FA_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_BedPtnrRmate, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_BedPtnrRmate + THC, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + THC, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + THC + PainInterf_Tscore, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + PainInterf_Tscore, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + PainInterf_Tscore + Taste_AgeAdj, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + PainInterf_Tscore + Taste_AgeAdj + SSAGA_Depressive_Ep, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + PainInterf_Tscore + Taste_AgeAdj + SSAGA_Depressive_Ep, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_BedPtnrRmate + THC, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_Quality + PSQI_BedPtnrRmate + PainInterf_Tscore + Taste_AgeAdj + SSAGA_Depressive_Ep, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + Ethnicity, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + Ethnicity + Race, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + Ethnicity + Race, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_BedPtnrRmate + THC + Race, df.std))
summary(lm(LifeSatisfaction ~ Age + Sex + ThoughtProblems + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + SSAGA_InSchool + BMI + PSQI_BedPtnrRmate + THC + Ethnicity, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + Ethnicity + Race, df.std))
df.std$Race
hist(df.std$Race)
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + Ethnicity + Race, df.std))
summary(lm(ODI_FIC_R ~ Age + Sex + LifeSatisfaction + SSAGA_Educ + SSAGA_Rlshp + SSAGA_Income + SSAGA_Employ + Ethnicity + NEORAW_38, df.std))
library(scales)
df <- read.csv("diff.tract.bundles.along.dti.map.FA_median.group.sizes.csv")
hist(df)
hist(df)
x <- scan("diff.tract.bundles.along.dti.map.FA_median.group.sizes.csv")
hist(x)
sum(x > 1.6) / length(x)
sum(x > 1.3) / length(x)
sum(x > 1.25) / length(x)
View(df.roi.odi)
View(df.lhmesh.odi)
setwd("~/repos/span-mri/docs/reports/2021-03-30")
# Chunk 1: global_options
w = 7
h = 7
#knitr::opts_chunk$set(fig.width=w, fig.height=h, fig.path='figs/',
#                      echo=FALSE, warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
options(xtable.comment = FALSE)
# Chunk 2: setup
library(stargazer)
library(ggplot2)
library(gridExtra)
library(xtable)
library(papeR)
library(scales)
library(ggplot2)
library(reshape2)
library(dplyr)
df <- read.csv("table.wide.csv")
df$tbv <- df$volume_tissue + df$volume_lesion + df$volume_csf
df$site <- as.factor(df$site)
df$timepoint <- as.factor(df$timepoint)
df$fraction_left <- df$midline_tissue_volume_left / df$tbv
df$fraction_right <- df$midline_tissue_volume_right / df$tbv
df$fraction_lesion <- df$volume_lesion / df$tbv
df$fraction_csf <- df$volume_csf / df$tbv
df$t2_snr <- df$t2_qa_snr
df$adc_snr <- df$adc_qa_snr
# Chunk 3: plot_snr
sub.df <- df[,c("site", "adc_snr", "t2_snr")]
melted <- melt(sub.df, id.vars=c("site"))
my.plot <- ggplot(data=melted, aes(x=site, y=value, fill=variable)) + geom_point(position=position_jitterdodge(jitter.width=0.2), aes(color=variable), alpha=0.2) + geom_boxplot(alpha=0.5, outlier.shape=NA) + ylim(0, 15)
grid.arrange(my.plot, nrow = 1)
# Chunk 4: table_snr
sub.df <- df[,c("site", "adc_snr", "t2_snr")]
melted <- melt(sub.df, id.vars=c("site"))
grouped <- group_by(melted, site, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 5: plot_tbv
my.plot <- ggplot(data=df, aes(x=site, y=tbv, fill=site)) + geom_jitter(alpha=0.2, width=0.15, aes(color=site)) + geom_boxplot(alpha=0.5, outlier.shape=NA)
grid.arrange(my.plot, nrow = 1)
# Chunk 6: table_tbv
sub.df <- df[,c("site", "tbv")]
melted <- melt(sub.df, id.vars=c("site"))
grouped <- group_by(melted, site, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 7: plot_lesion_early
my.plot <- ggplot(data=df[df$timepoint == "early",], aes(x=site, y=volume_lesion, fill=site)) + geom_jitter(alpha=0.2, width=0.15, aes(color=site)) + geom_boxplot(alpha=0.5, outlier.shape=NA)
grid.arrange(my.plot, nrow = 1)
# Chunk 8: table_lesion_early
sub.df <- df[df$timepoint=="early",c("site", "volume_lesion")]
melted <- melt(sub.df, id.vars=c("site"))
grouped <- group_by(melted, site, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 9: plot_fraction_lesion_early
my.plot <- ggplot(data=df[df$timepoint == "early",], aes(x=site, y=fraction_lesion, fill=site)) + geom_jitter(alpha=0.2, width=0.15, aes(color=site)) + geom_boxplot(alpha=0.5, outlier.shape=NA)
grid.arrange(my.plot, nrow = 1)
# Chunk 10: table_fraction_lesion_early
sub.df <- df[df$timepoint=="early",c("site", "fraction_lesion")]
melted <- melt(sub.df, id.vars=c("site"))
grouped <- group_by(melted, site, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 11: plot_csf_both
my.plot <- ggplot(data=df, aes(x=site, y=volume_csf, fill=timepoint)) + geom_point(position = position_jitterdodge(jitter.width=0.2), aes(color=timepoint), alpha=0.35) + geom_boxplot(alpha=0.2, outlier.shape=NA) + ylim(0, 30)
grid.arrange(my.plot, nrow = 1)
# Chunk 12: table_csf_both
sub.df <- df[,c("timepoint", "site", "volume_csf")]
melted <- melt(sub.df, id.vars=c("timepoint", "site"))
grouped <- group_by(melted, site, timepoint, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, timepoint, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 13: plot_fraction_csf_both
my.plot <- ggplot(data=df, aes(x=site, y=fraction_csf, fill=timepoint)) + geom_point(position = position_jitterdodge(jitter.width=0.2), aes(color=timepoint), alpha=0.35) + geom_boxplot(alpha=0.2, outlier.shape=NA) + ylim(0, 0.1)
grid.arrange(my.plot, nrow = 1)
# Chunk 14: table_fraction_csf_both
sub.df <- df[,c("timepoint", "site", "fraction_csf")]
melted <- melt(sub.df, id.vars=c("timepoint", "site"))
grouped <- group_by(melted, site, timepoint, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, timepoint, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 15: plot_shift_both
my.plot <- ggplot(data=df, aes(x=site, y=midline_shift_index, fill=timepoint)) + geom_point(position = position_jitterdodge(jitter.width=0.2), aes(color=timepoint), alpha=0.35) + geom_boxplot(alpha=0.2, outlier.shape=NA) + ylim(-.50, .50)
grid.arrange(my.plot, nrow = 1)
# Chunk 16: table_shift_both
sub.df <- df[,c("timepoint", "site", "midline_shift_index")]
melted <- melt(sub.df, id.vars=c("timepoint", "site"))
grouped <- group_by(melted, site, timepoint, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, timepoint, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 17: plot_hemi_early
sub.df <- df[df$timepoint=="early",c("site", "fraction_left", "fraction_right")]
melted <- melt(sub.df, id.vars=c("site"))
my.plot <- ggplot(data=melted, aes(x=site, y=value, fill=variable)) + geom_point(position = position_jitterdodge(), aes(color=variable), alpha=0.35) + geom_boxplot(alpha=0.2, outlier.shape=NA)
grid.arrange(my.plot, nrow = 1)
# Chunk 18: table_hemi_early
sub.df <- df[df$timepoint=="early",c("site", "fraction_left", "fraction_right")]
melted <- melt(sub.df, id.vars=c("site"))
grouped <- group_by(melted, site, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 19: plot_hemi_late
sub.df <- df[df$timepoint=="late",c("site", "fraction_left", "fraction_right")]
melted <- melt(sub.df, id.vars=c("site"))
my.plot <- ggplot(data=melted, aes(x=site, y=value, fill=variable)) + geom_point(position = position_jitterdodge(), aes(color=variable), alpha=0.35) + geom_boxplot(alpha=0.2, outlier.shape=NA)
grid.arrange(my.plot, nrow = 1)
# Chunk 20: table_hemi_late
sub.df <- df[df$timepoint=="late",c("site", "fraction_left", "fraction_right")]
melted <- melt(sub.df, id.vars=c("site"))
grouped <- group_by(melted, site, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
grouped <- group_by(melted, variable)
xtable(summarise(grouped, num=length(value), mean=mean(value, na.rm=T), sd=sd(value, na.rm=T), min=min(value, na.rm=T), max=max(value, na.rm=T), cv=sd/mean))
# Chunk 21: plot_lesion_shift
my.plot <- ggplot(data=df[df$timepoint=="early",], aes(x=volume_lesion, y=midline_shift_mm, color=site)) + geom_point(alpha=0.5) + geom_smooth(method="lm") + ylim(0, 0.5)
grid.arrange(my.plot, nrow = 1)
# Chunk 22: plot_lesion_shift_time
early.df <- df[df$timepoint=="early", c("subject", "site", "fraction_lesion")]
late.df <- df[df$timepoint=="late", c("subject", "midline_shift_index")]
sub.df <- merge(early.df, late.df, field="subject")
my.plot <- ggplot(data=sub.df, aes(x=fraction_lesion, y=midline_shift_index, color=site)) + geom_point(alpha=0.5) + geom_smooth(method="lm") + xlab("early timepoint lesion fraction") + ylab("late timepoint midline shift")
grid.arrange(my.plot, nrow = 1)
names(df)
